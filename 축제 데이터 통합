import pandas as pd
import os

# CSV 파일들이 저장된 폴더 경로
folder_path = '/content/drive/MyDrive/축제파일/축제 개별 데이터'
csv_files = [f for f in os.listdir(folder_path) if f.endswith('.csv')]

merged_df = pd.DataFrame()

for file in csv_files:
    file_path = os.path.join(folder_path, file)
    try:
        with open(file_path, 'r', encoding='utf-8', errors='ignore') as f:
            df = pd.read_csv(f)
    except Exception:
        try:
            with open(file_path, 'r', encoding='cp949', errors='ignore') as f:
                df = pd.read_csv(f)
        except:
            print(f"실패: {file}")
            continue
    df['파일명'] = file
    merged_df = pd.concat([merged_df, df], ignore_index=True)

# 글자 안 깨지게 저장!
merged_df.to_csv(os.path.join(folder_path, '축제_통합_최종본_100개.csv'), index=False, encoding='utf-8-sig')

print(f"총 파일 개수: {len(csv_files)}")
print(f"병합된 행 수: {len(merged_df)}")